//Implementation fault attack against DES
#include <stdio.h>
#include <stdlib.h>
#include <gmp.h>
#include<stdint.h>

int K16[64][6] = {
	{0,0,0,0,0,0},
	{0,0,0,0,0,1},
	{0,0,0,0,1,0},
	{0,0,0,0,1,1},
	{0,0,0,1,0,0},
	{0,0,0,1,0,1},
	{0,0,0,1,1,0},
	{0,0,0,1,1,1},
	{0,0,1,0,0,0},
	{0,0,1,0,0,1},
	{0,0,1,0,1,0},
	{0,0,1,0,1,1},
	{0,0,1,1,0,0},
	{0,0,1,1,0,1},
	{0,0,1,1,1,0},
	{0,0,1,1,1,1},
	{0,1,0,0,0,0},
	{0,1,0,0,0,1},
	{0,1,0,0,1,0},
	{0,1,0,0,1,1},
	{0,1,0,1,0,0},
	{0,1,0,1,0,1},
	{0,1,0,1,1,0},
	{0,1,0,1,1,1},
	{0,1,1,0,0,0},
	{0,1,1,0,0,1},
	{0,1,1,0,1,0},
	{0,1,1,0,1,1},
	{0,1,1,1,0,0},
	{0,1,1,1,0,1},
	{0,1,1,1,1,0},
	{0,1,1,1,1,1},
	{1,0,0,0,0,0},
	{1,0,0,0,0,1},
	{1,0,0,0,1,0},
	{1,0,0,0,1,1},
	{1,0,0,1,0,0},
	{1,0,0,1,0,1},
	{1,0,0,1,1,0},
	{1,0,0,1,1,1},
	{1,0,1,0,0,0},
	{1,0,1,0,0,1},
	{1,0,1,0,1,0},
	{1,0,1,0,1,1},
	{1,0,1,1,0,0},
	{1,0,1,1,0,1},
	{1,0,1,1,1,0},
	{1,0,1,1,1,1},
	{1,1,0,0,0,0},
	{1,1,0,0,0,1},
	{1,1,0,0,1,0},
	{1,1,0,0,1,1},
	{1,1,0,1,0,0},
	{1,1,0,1,0,1},
	{1,1,0,1,1,0},
	{1,1,0,1,1,1},
	{1,1,1,0,0,0},
	{1,1,1,0,0,1},
	{1,1,1,0,1,0},
	{1,1,1,0,1,1},
	{1,1,1,1,0,0},
	{1,1,1,1,0,1},
	{1,1,1,1,1,0},
	{1,1,1,1,1,1}
};

int Sbox[8][4][16] = {
	{
		{14,	4,	13,	1,	2,	15,	11,	8,	3,	10,	6,	12,	5,	9,	0,	7},
		{0,	15,	7,	4,	14,	2,	13,	1,	10,	6,	12,	11,	9,	5,	3,	8},
		{4,	1,	14,	8,	13,	6,	2,	11,	15,	12,	9,	7,	3,	10,	5,	0},
		{15,	12,	8,	2,	4,	9,	1,	7,	5,	11,	3,	14,	10,	0,	6,	13}
	},
	{
		{15,	1,	8,	14,	6,	11,	3,	4,	9,	7,	2,	13,	12,	0,	5,	10},
		{3,	13,	4,	7,	15,	2,	8,	14,	12,	0,	1,	10,	6,	9,	11,	5},
		{0,	14,	7,	11,	10,	4,	13,	1,	5,	8,	12,	6,	9,	3,	2,	15},
		{13,	8,	10,	1,	3,	15,	4,	2,	11,	6,	7,	12,	0,	5,	14,	9}
	},
	{
		{10,	0,	9,	14,	6,	3,	15,	5,	1,	13,	12,	7,	11,	4,	2,	8},
		{13,	7,	0,	9,	3,	4,	6,	10,	2,	8,	5,	14,	12,	11,	15,	1},
		{13,	6,	4,	9,	8,	15,	3,	0,	11,	1,	2,	12,	5,	10,	14,	7},
		{1,	10,	13,	0,	6,	9,	8,	7,	4,	15,	14,	3,	11,	5,	2,	12}
	},
	{
		{7,	13,	14,	3,	0,	6,	9,	10,	1,	2,	8,	5,	11,	12,	4,	15},
		{13,	8,	11,	5,	6,	15,	0,	3,	4,	7,	2,	12,	1,	10,	14,	9},
		{10,	6,	9,	0,	12,	11,	7,	13,	15,	1,	3,	14,	5,	2,	8,	4},
		{3,	15,	0,	6,	10,	1,	13,	8,	9,	4,	5,	11,	12,	7,	2,	14}
	},
	{
		{2,	12,	4,	1,	7,	10,	11,	6,	8,	5,	3,	15,	13,	0,	14,	9},
		{14,	11,	2,	12,	4,	7,	13,	1,	5,	0,	15,	10,	3,	9,	8,	6},
		{4,	2,	1,	11,	10,	13,	7,	8,	15,	9,	12,	5,	6,	3,	0,	14},
		{11,	8,	12,	7,	1,	14,	2,	13,	6,	15,	0,	9,	10,	4,	5,	3}
	},
	{
		{12,	1,	10,	15,	9,	2,	6,	8,	0,	13,	3,	4,	14,	7,	5,	11},
		{10,	15,	4,	2,	7,	12,	9,	5,	6,	1,	13,	14,	0,	11,	3,	8},
		{9,	14,	15,	5,	2,	8,	12,	3,	7,	0,	4,	10,	1,	13,	11,	6},
		{4,	3,	2,	12,	9,	5,	15,	10,	11,	14,	1,	7,	6,	0,	8,	13}
	},
	{
		{4,	11,	2,	14,	15,	0,	8,	13,	3,	12,	9,	7,	5,	10,	6,	1},
		{13,	0,	11,	7,	4,	9,	1,	10,	14,	3,	5,	12,	2,	15,	8,	6},
		{1,	4,	11,	13,	12,	3,	7,	14,	10,	15,	6,	8,	0,	5,	9,	2},
		{6,	11,	13,	8,	1,	4,	10,	7,	9,	5,	0,	15,	14,	2,	3,	12}
	},
	{
		{13,	2,	8,	4,	6,	15,	11,	1,	10,	9,	3,	14,	5,	0,	12,	7},
		{1,	15,	13,	8,	10,	3,	7,	4,	12,	5,	6,	11,	0,	14,	9,	2},
		{7,	11,	4,	1,	9,	12,	14,	2,	0,	6,	10,	13,	15,	3,	5,	8},
		{2,	1,	14,	7,	4,	10,	8,	13,	15,	12,	9,	0,	3,	5,	6,	11}
	}
};

void IPpermut(int* x){
	
	int ip[] = {
		58,	50,	42,	34,	26,	18,	10,	2,
		60,	52,	44,	36,	28,	20,	12,	4,
		62,	54,	46,	38,	30,	22,	14,	6,
		64,	56,	48,	40,	32,	24,	16,	8,
		57,	49,	41,	33,	25,	17,	9,	1,
		59,	51,	43,	35,	27,	19,	11,	3,
		61,	53,	45,	37,	29,	21,	13,	5,
		63,	55,	47,	39,	31,	23,	15,	7
	};
	int tmp;
	int res[64]; 
	for (int i = 0; i < 64; i++){
		tmp = ip[i];
		res[i] = x[tmp-1];
	}
	for (int i = 0; i < 64; i ++){
		x[i] = res[i];
	}
} 

void PINVpermut(int* x){
	
	int pinv[] = {
		9,	17,	23,	31,
		13,	28,	2,	18,
		24,	16,	30,	6,
		26,	20,	10,	1,
		8,	14,	25,	3,
		4,	29,	11,	19,
		32,	12,	22,	7,
		5,	27,	15,	21
	};
	int tmp;
	int res[32]; 
	//printf("permutation du chiffré : \n");
	for (int i = 0; i < 32; i++){
		tmp = pinv[i];
		res[i] = x[tmp-1];
		//printf("%d",res[i]);
		//if (i ==3 || i ==  7 || i == 11 || i == 15 || i == 19 || i == 23 || i == 27)
        //		printf(" ");
	}
	//printf("\n");
	for (int i = 0; i < 32; i ++){
		x[i] = res[i];
	}
}

void Expansion(int* x, int* y){
	int E[] = {
		32,	1,	2,	3,	4,	5,
		4,	5,	6,	7,	8,	9,
		8,	9,	10,	11,	12,	13,
		12,	13,	14,	15,	16,	17,
		16,	17,	18,	19,	20,	21,
		20,	21,	22,	23,	24,	25,
		24,	25,	26,	27,	28,	29,
		28,	29,	30,	31,	32,	1
	};
	for (int i = 0; i < 48; i ++){
		x[i] = y[E[i]];
	}
}

void SBOX_FINDER (int* FC,int* res){
		int C[] = {	0,0,0,1,1,1,1,0,
			1,1,1,1,0,1,0,0,
			1,0,0,1,1,1,1,1,
			0,1,0,0,0,0,0,1,
			0,1,1,0,1,1,0,1,
			1,1,0,1,0,1,0,1,
			0,1,0,1,0,1,1,1,
			1,0,0,0,1,0,1,0};
        IPpermut(FC);
        IPpermut(C);
        int p_FC32[32], p_C32[32];
        for (int i = 0; i < 32; i ++){
                p_FC32[i] = FC[i];
                p_C32[i] = C[i];
        }
        for (int i = 0; i < 32; i++){
                res[i] = (p_FC32[i] + p_C32[i]) % 2 ;
        }
        PINVpermut(res);
        //division de res en 8 tableau de 4 bits 
        //chaque tableau correspond a une S-BOX
        int S[8][4];
        for (int i = 0; i < 32; i ++){
        	if (i < 4){
        		S[0][i%4] = res[i];
        		//printf("%d",S[0][i%4]);
        	}
        	else if (i < 8){
        		S[1][i%4] = res[i];
        		//printf("%d",S[1][i%4]);
        	}
        	else if (i < 12){
        		S[2][i%4] = res[i];
        		//printf("%d",S[2][i%4]);
        	}
        	else if (i < 16){
        		S[3][i%4] = res[i];
        		//printf("%d",S[3][i%4]);
        	}
        	else if (i < 20){
        		S[4][i%4] = res[i];
        		//printf("%d",S[4][i%4]);
        	}
        	else if (i < 24){
        		S[5][i%4] = res[i];
        		//printf("%d",S[5][i%4]);		
        	}
        	else if (i < 28){
        		S[6][i%4] = res[i];
        		//printf("%d",S[6][i%4]);
        	}
        	else if (i < 32){
        		S[7][i%4] = res[i];
        		//printf("%d",S[7][i%4]);
        	}
        }
        for (int i = 0; i < 8; i ++){
        	if (S[i][0] + S[i][1] + S[i][2] + S[i][3] > 0){
        		printf("SBOX %d ", i+1);        
        	}
        }
}

void SubKey16finder (){
	//ensemble des chiffrés faux
	int FC[32][64] = {
		{0,0,0,1,1,1,0,0,1,1,1,0,0,1,0,1,1,0,0,1,1,1,1,1,0,1,0,0,0,1,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,1,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,1,0,1,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,0,0,1,0,0,1,0,0,1,1,1,0,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,1,1,0,1,1,0,0,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,1,1,0,1,0,0,1,0,0,1,0,0,1,1,0,1,1,0,1,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,1,1,0,1,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,0,1,1,0,1,0,0,1,0,0,1,1,0,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,1,1,0,1,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,1,1,1,1,0,1,1,1,0,1,0,0,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,0,0},
	 	{0,0,0,1,0,1,1,0,1,0,1,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,0,0,1,1,1,1,1,0,1,1,1,0,0,0,0,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,1,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1,1,0,0,0,0,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,1,0,1,1,1,0,1,0,0,0,0,0,0,0,1,1,0,1,1,0,1,1,1,0,0,0,1,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,0,1,1,1,1,0,1,0,0,1,0,0,0,0,0,1,0,1,1,0,1,1,1,0,1,0,0,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,1},
	 	{0,1,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,0,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,1,1,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,1},
	 	{0,1,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,0,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1,0,0,0,1,0,1,1},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,0,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,0,0,0,0,1,1},
	 	{0,1,1,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,0,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,0,0,1,0,1,0,1,0,1,0,0,0,1,1,1,1,1,0,0,1,0,1,1},
	 	{0,0,0,1,1,1,1,0,1,1,0,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,1,0,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,1,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,0,0,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,1,1,0,0,1,0,1,0},
	 	{0,0,0,0,1,0,1,0,1,1,1,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,1,0,0,0,0,1,0,1,1,0,1,0,0,1,1,1,0,1,0,1,0,1,0,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0},
	 	{0,0,0,1,1,0,1,0,1,1,1,1,0,1,0,0,1,1,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,0,0,1,1,0,1,1,1,0,1,0,1,0,1,0,1,0,0,0,1,1,1,1,1,0,0,1,0,1,0},
	 	{0,0,0,1,1,0,1,0,1,1,1,1,0,1,0,0,1,1,0,1,1,1,1,0,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,1,1,0,1,0,1,0,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,0,1,0,1,0,1,1,1,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,1,0,1,1,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,0,1,0,1,0,1,1,1,1,0,1,0,0,1,1,0,1,1,1,1,1,0,1,0,1,0,0,0,1,0,1,1,0,1,1,0,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,0,1,0,1,0,1,0},
	 	{1,0,0,0,1,0,1,0,1,1,1,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,0,1,1,0,1,0,1,0,1,0,0,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,0,1,1,1,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,0,1,1,0,1,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,0,0,0,0,1,1,1,1,1,0,1,0,1,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,1,1,0,0,1,1,1,1,1,1,1,0,1,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,1,0,0,0,1,0,1,1,1,1,0,0,1,1,1,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,0,0,1,1,0,0,1,1,1,1,1,0,1,0,1,0,0,0,1,1,1,1,0,1,1,0,0,1,1,0,1,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,1,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,1,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,0,0,1,1,1,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,0,0,1,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,1,1,1,0,1,0,1,1,1,1,0,0,0,1,0,1,0},
	 	{0,0,0,1,1,1,1,0,1,1,1,1,0,0,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,1,0,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,1,0,1,1,1,0,0,0,1,1,0,1,0}                        
	};

	//chiffré juste
	int C[] = {	0,0,0,1,1,1,1,0,
			1,1,1,1,0,1,0,0,
			1,0,0,1,1,1,1,1,
			0,1,0,0,0,0,0,1,
			0,1,1,0,1,1,0,1,
			1,1,0,1,0,1,0,1,
			0,1,0,1,0,1,1,1,
			1,0,0,0,1,0,1,0};
	
	//chiffrés faux à utiliser contre les SBOX identifié grâce à la fonction SBOX_FINDER
	int SBOX_opponent[8][6] = {
		{1, 28, 29, 30, 31, 32},
		{23, 24, 25, 26, 27, 28},
		{19, 20, 21, 22, 23, 24},
		{15, 16, 17, 18, 19, 20},
		{11, 12, 13, 14, 15, 16},
		{7, 8, 9, 10, 11, 11},
		{3, 4, 5, 6, 7, 8},
		{0, 1, 2, 3, 4, 31}
	};
	
	//TROUVER K16
	int CL16[32], CR16[32], FCL16[32], FCR15[32], REFERENCE[32] /* P-1(L16 XOR L16*) */;
	int E_CR15[48], E_FCR15[48];
	int tmpC[6], tmpFC[6]; //variables à utiliser pour les S-BOX
	int SBOX_res[8][6]; //resultat des attaques sur les S-BOX
	for (int i = 0; i < 8; i ++){
		for (int j = 0; j < 6; j ++){
			SBOX_res[i][j] = -1;
		}
	}

	//utilisé pour chaques S-BOX
	IPpermut(C); //permutation IP(C)
	for (int i = 0; i < 64; i ++){
		if (i < 32)
			CL16[i] = C[i]; //L16 = 32 premiers bits de C
		if (i > 31)
			CR16[i-32] = C[i]; //R16 = 32 derniers bits de C
	}

	for (int i = 0; i < 8; i++){
		printf("##############SBOX %d #############\n", i);
		for (int j = 0; j < 6; j ++){
			//assignation du FC 
			int usedFC = SBOX_opponent[i][j]; //FC a utiliser
			int tmpFC[64];
			for (int k = 0; k < 64; k++){
				tmpFC[k] = FC[usedFC][k];
			}
			IPpermut(tmpFC);
			//assignation de FC16 et FCR15
			for (int k = 0; k < 32; k ++){
					FCL16[k] = tmpFC[k]; //FCL16 = 32 premiers bits de FC
					FCR15[k] = CR16[k]; //FCR15 = 32 derniers bit de C
			}
			//assignation de REFERENCE = P-1(CL16 XOR FCL16)
			for (int k = 0; k < 32; k ++){
				REFERENCE[k] = CL16[k] + FCL16[k] % 2;
				PINVpermut(REFERENCE);
			}
			//assignation E_CR15 et E_FCR15
			Expansion(E_CR15, CR16);
			Expansion(E_FCR15, FCR15);

			//recherche exhaustive de K16
			for (int k = 0; k < 64; k ++){
				for (int l = 0; l < 6; l++){
					tmpC[l] = E_CR15[i*6+l] + K16[k][i*6+l] % 2;
					tmpFC[l] = E_FCR15[i*6+l] + K16[k][i*6+l] % 2;
				}
			}

			//passage dans la S-box
			//on résupère d'abords les bits externes de tmpC et tmpFC et leurs bits internes 
			int extTmpC[2], extTmpFC[2], intTmpC[4], intTmpFC[4];
			extTmpC[0] = tmpC[0];
			extTmpFC[0] = tmpFC[0];
			for (int k = 1; k < 5; k++){
				intTmpC[k] = tmpC[k];
				intTmpFC[k] = tmpFC[k];
			}

			//calcul des lignes et colonnes de la S-BOX
			int rowC = 0, columnC = 0;
			int rowFC = 0, columnFC = 0;
			//row
			{
				if (extTmpC[0] == 1){
					rowC += 2;
				}
				if (extTmpC[1] == 1){
					rowC += 1;
				}
				if (extTmpFC[0] == 1){
					rowFC += 2;  
				}
				if (extTmpFC[1] == 1){
					rowFC += 1;
				}
			}
			//column
			{
				if (intTmpC[0] == 1){
					columnC += 8;
				}
				if (intTmpC[1] == 1){
					columnC += 4;
				}
				if (intTmpC[2] == 1){
					columnC += 2;
				}
				if (intTmpC[3] == 1){
					columnC += 1;
				}
				if (intTmpFC[0] == 1){
					columnFC += 8;
				}
				if (intTmpFC[1] == 1){
					columnFC += 4;
				}
				if (intTmpFC[2] == 1){
					columnFC += 2;
				}
				if (intTmpFC[3] == 1){
					columnFC += 1;
				}
			}
			int solution = Sbox[i][rowC][columnC] ^ Sbox[i][rowFC][columnFC];
			printf("SOLUTION = % d  REFERENCE = ", solution);
			for (int k = 0; k < 4; k++){
				printf("%d ", REFERENCE[i*4+k]);
			}
			printf("\n");
			//printf ("C = %d  FC = %d \n", Sbox[i][rowC][columnC], Sbox[i][rowFC][columnFC]); 

		}
	} 
	

	//indentifiction des chiffrés faux à utiliser contre les SBOX
	/*int res[32];
	for (int i = 0; i < 32; i ++){
		SBOX_FINDER(FC[i], res);
		printf("\n");
	}*/
}

int main (){

	SubKey16finder();
	
		
	return(0);	
}
